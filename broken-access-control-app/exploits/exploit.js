const jwt = require('jsonwebtoken');
let cipher = process.argv[2];

let data = {
	username: 'zeltron'
}

let product = (charset, key_size, cipher) => {
	let stack = [];
	let temp = '', i;
	let json = {};
	for (i = 0; i < 26; i += 1) {
		stack.push(charset[i]);
	}
	while (stack.length > 0) {
		temp = stack.pop();
		if (temp.length == key_size) {
			try {
				json = jwt.decode(cipher, temp);
				if (json.username) {
					break;
				} else {
					continue;
				}
			} catch (error) {
				continue;
			}
		} else {
			for (i = 0; i < 26; i += 1) {
				stack.push(temp + charset[i]);
			}
		}
	}
}

let brute_force = (cipher) => {
	let key_size = 2;
	let charset = 'abcdefghijklmnopqrstuvwxyz'.split('').reverse();
	let i;
	for (i = 1; i <= key_size; i += 1) {
		product(charset, i, cipher);
	}
}

brute_force(cipher);
