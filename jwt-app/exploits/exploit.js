const jwt = require('jsonwebtoken');
let cipher = process.argv[2];

let data = jwt.decode(cipher);
console.log(data);

function brute_force(data, key_size) {
	let charset = 'abcdefghijklmnopqrstuvwxyz'.split("").reverse();
	for (let i = 1; i <= key_size; i ++) {
		product(charset, i, data);
	}
}


function product(charset, key_size, data) {
	let stack = [];
	let temp = '';
	for (let i = 0; i < 26; i ++) {
		stack.push(charset[i]);
	}
	while (stack.length > 0) {
		temp = stack.pop();
		if (temp.length == key_size) {
			if (jwt.sign(data, temp) == cipher) {
				console.log('Correct HMAC key:', temp);
				break;
			} else {
				console.log('Wrong key:', temp);
			}
		} else {
			for (let i = 0; i < 26; i += 1) {
				stack.push(temp + charset[i]);
			}
		}
	}
}

brute_force(data, 2);
